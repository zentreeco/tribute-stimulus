function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var e=require("stimulus"),i=t(require("tributejs")),r=t(require("trix")),n=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.connect=function(){this.editor=this.fieldTarget.editor,this.initializeTribute()},e.prototype.disconnect=function(){this.tribute.detach(this.fieldTarget)},e.prototype.initializeTribute=function(){this.tribute=new i({allowSpaces:!0,lookup:"name",values:this.fetchUsers}),this.tribute.attach(this.fieldTarget),this.tribute.range.pasteHtml=this._pasteHtml.bind(this),this.fieldTarget.addEventListener("tribute-replaced",this.replaced)},e.prototype.fetchUsers=function(t,e){fetch("/mentions.json?query="+t).then(function(t){return t.json()}).then(function(t){return e(t)}).catch(function(t){return e([])})},e.prototype.replaced=function(t){var e=t.detail.item.original,i=new r.Attachment({sgid:e.sgid,content:e.content});this.editor.insertAttachment(i),this.editor.insertString(" ")},e.prototype._pasteHtml=function(t,e,i){var r=this.editor.getPosition();this.editor.setSelectedRange([r-i,r]),this.editor.deleteInDirection("backward")},e}(e.Controller);n.targets=["field"],module.exports=n;
//# sourceMappingURL=index.js.map
